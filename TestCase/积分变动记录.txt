*** Settings ***
Resource          ../Keywords-公共/0-自定义关键字.txt

*** Test Cases ***
商户增加积分，查看积分变动记录
    ${剩余积分}    通过手机号获取用户账户信息    ${G_用户手机号}    bonus
    增加积分    ${G_用户手机号}    ${剩余积分}    ${剩余积分}    10
    # 验证余额变动记录
    ${增加后积分}    Evaluate    int(${剩余积分})+10
    获取积分变动记录    ${G_用户手机号}
    获取积分变动记录-验证一条记录    1    商户增加    10    ${增加后积分}

商户增加积分，查看会员信息记录
    ${剩余积分}    通过手机号获取用户账户信息    ${G_用户手机号}    bonus
    ${累计获得积分}    通过手机号获取用户账户信息    ${G_用户手机号}    sumBonusRecharge
    增加积分    ${G_用户手机号}    ${剩余积分}    ${剩余积分}    10
    ${增加后积分}    Evaluate    int(${剩余积分})+10
    ${增加后累计获得积分}    Evaluate    int(${累计获得积分})+10
    ${剩余积分-新}    通过手机号获取用户账户信息    ${G_用户手机号}    bonus
    ${累计获得积分-新}    通过手机号获取用户账户信息    ${G_用户手机号}    sumBonusRecharge
    # 剩余积分增加，累计获得积分增加
    Should Be Equal As Strings    ${增加后积分}    ${剩余积分-新}
    Should Be Equal As Strings    ${增加后累计获得积分}    ${累计获得积分-新}

商户增加积分，查看会员详情记录
    ${剩余积分}    通过手机号获取用户账户信息    ${G_用户手机号}    bonus
    ${累计获得积分}    通过手机号获取用户账户信息    ${G_用户手机号}    sumBonusRecharge
    增加积分    ${G_用户手机号}    ${剩余积分}    ${剩余积分}    10
    ${增加后积分}    Evaluate    int(${剩余积分})+10
    ${增加后累计获得积分}    Evaluate    int(${累计获得积分})+10
    获取会员明细    ${G_用户手机号}
    ${剩余积分-新}    获取会员明细-获取账户信息    剩余积分
    ${累计获得积分-新}    获取会员明细-获取账户信息    累计获得积分
    # 剩余积分增加，累计获得积分增加
    Should Be Equal As Strings    ${增加后积分}    ${剩余积分-新}
    Should Be Equal As Strings    ${增加后累计获得积分}    ${累计获得积分-新}

商户扣减积分，查看积分变动记录
    ${剩余积分}    通过手机号获取用户账户信息    ${G_用户手机号}    bonus
    减少积分    ${G_用户手机号}    ${剩余积分}    ${剩余积分}    10
    获取积分变动记录    ${G_用户手机号}
    ${扣减后积分}    Evaluate    int(${剩余积分})-10
    获取积分变动记录-验证一条记录    1    商户扣减    -10    ${扣减后积分}

商户扣减积分，查看会员信息记录
    ${剩余积分}    通过手机号获取用户账户信息    ${G_用户手机号}    bonus
    ${累计获得积分}    通过手机号获取用户账户信息    ${G_用户手机号}    sumBonusRecharge
    减少积分    ${G_用户手机号}    ${剩余积分}    ${剩余积分}    10
    ${扣减后积分}    Evaluate    int(${剩余积分})-10
    ${扣减后累计获得积分}    Evaluate    int(${累计获得积分})-10
    ${剩余积分-新}    通过手机号获取用户账户信息    ${G_用户手机号}    bonus
    ${累计获得积分-新}    通过手机号获取用户账户信息    ${G_用户手机号}    sumBonusRecharge
    # 剩余积分减少，累计积分不变
    Should Be Equal As Strings    ${扣减后积分}    ${剩余积分-新}
    Should Be Equal As Strings    ${累计获得积分}    ${累计获得积分-新}

商户扣减积分，查看会员详情记录
    ${剩余积分}    通过手机号获取用户账户信息    ${G_用户手机号}    bonus
    ${累计获得积分}    通过手机号获取用户账户信息    ${G_用户手机号}    sumBonusRecharge
    减少积分    ${G_用户手机号}    ${剩余积分}    ${剩余积分}    10
    ${扣减后积分}    Evaluate    int(${剩余积分})-10
    ${扣减后累计获得积分}    Evaluate    int(${累计获得积分})-10
    获取会员明细    ${G_用户手机号}
    ${剩余积分-新}    获取会员明细-获取账户信息    剩余积分
    ${累计获得积分-新}    获取会员明细-获取账户信息    累计获得积分
    # 剩余积分减少，累计积分不变
    Should Be Equal As Strings    ${扣减后积分}    ${剩余积分-新}
    Should Be Equal As Strings    ${累计获得积分}    ${累计获得积分-新}

POS机增加积分，查看积分变动记录
    ${剩余积分}    通过手机号获取用户账户信息    ${G_用户手机号}    bonus
    二维码修改会员积分    ${G_用户手机号}    10    1
    ${增加后积分}    Evaluate    int(${剩余积分})+10
    获取积分变动记录    ${G_用户手机号}
    获取积分变动记录-验证一条记录    1    POS机赠送    10    ${增加后积分}

POS机增加积分，查看会员信息记录
    ${剩余积分}    通过手机号获取用户账户信息    ${G_用户手机号}    bonus
    ${累计获得积分}    通过手机号获取用户账户信息    ${G_用户手机号}    sumBonusRecharge
    二维码修改会员积分    ${G_用户手机号}    10    1
    ${增加后积分}    Evaluate    int(${剩余积分})+10
    ${增加后累计获得积分}    Evaluate    int(${累计获得积分})+10
    ${剩余积分-新}    通过手机号获取用户账户信息    ${G_用户手机号}    bonus
    ${累计获得积分-新}    通过手机号获取用户账户信息    ${G_用户手机号}    sumBonusRecharge
    # 剩余积分增加，累计获得积分增加
    Should Be Equal As Strings    ${增加后积分}    ${剩余积分-新}
    Should Be Equal As Strings    ${增加后累计获得积分}    ${累计获得积分-新}

POS机增加积分，查看会员详情记录
    ${剩余积分}    通过手机号获取用户账户信息    ${G_用户手机号}    bonus
    ${累计获得积分}    通过手机号获取用户账户信息    ${G_用户手机号}    sumBonusRecharge
    二维码修改会员积分    ${G_用户手机号}    10    1
    ${增加后积分}    Evaluate    int(${剩余积分})+10
    ${增加后累计获得积分}    Evaluate    int(${累计获得积分})+10
    获取会员明细    ${G_用户手机号}
    ${剩余积分-新}    获取会员明细-获取账户信息    剩余积分
    ${累计获得积分-新}    获取会员明细-获取账户信息    累计获得积分
    # 剩余积分增加，累计获得积分增加
    Should Be Equal As Strings    ${增加后积分}    ${剩余积分-新}
    Should Be Equal As Strings    ${增加后累计获得积分}    ${累计获得积分-新}

POS机扣减积分，查看积分变动记录
    ${剩余积分}    通过手机号获取用户账户信息    ${G_用户手机号}    bonus
    二维码修改会员积分    ${G_用户手机号}    10    2
    获取积分变动记录    ${G_用户手机号}
    ${扣减后积分}    Evaluate    int(${剩余积分})-10
    获取积分变动记录-验证一条记录    1    POS扣除    -10    ${扣减后积分}

POS机扣减积分，查看会员信息记录
    ${剩余积分}    通过手机号获取用户账户信息    ${G_用户手机号}    bonus
    ${累计获得积分}    通过手机号获取用户账户信息    ${G_用户手机号}    sumBonusRecharge
    二维码修改会员积分    ${G_用户手机号}    10    2
    ${扣减后积分}    Evaluate    int(${剩余积分})-10
    ${扣减后累计获得积分}    Evaluate    int(${累计获得积分})-10
    ${剩余积分-新}    通过手机号获取用户账户信息    ${G_用户手机号}    bonus
    ${累计获得积分-新}    通过手机号获取用户账户信息    ${G_用户手机号}    sumBonusRecharge
    # 剩余积分减少，累计积分不变
    Should Be Equal As Strings    ${扣减后积分}    ${剩余积分-新}
    Should Be Equal As Strings    ${累计获得积分}    ${累计获得积分-新}

POS机扣减积分，查看会员详情记录
    ${剩余积分}    通过手机号获取用户账户信息    ${G_用户手机号}    bonus
    ${累计获得积分}    通过手机号获取用户账户信息    ${G_用户手机号}    sumBonusRecharge
    二维码修改会员积分    ${G_用户手机号}    10    2
    ${扣减后积分}    Evaluate    int(${剩余积分})-10
    ${扣减后累计获得积分}    Evaluate    int(${累计获得积分})-10
    获取会员明细    ${G_用户手机号}
    ${剩余积分-新}    获取会员明细-获取账户信息    剩余积分
    ${累计获得积分-新}    获取会员明细-获取账户信息    累计获得积分
    # 剩余积分减少，累计积分不变
    Should Be Equal As Strings    ${扣减后积分}    ${剩余积分-新}
    Should Be Equal As Strings    ${累计获得积分}    ${累计获得积分-新}
