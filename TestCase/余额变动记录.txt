*** Settings ***
Resource          ../Keywords-公共/0-自定义关键字.txt

*** Test Cases ***
商户增加余额，查看余额变动记录
    ${random}    ${float_random}    随机一个带两位小数的金额    0    2
    ${账户余额}    通过手机号获取用户账户信息    ${G_用户手机号}    balance
    增加余额    ${G_用户手机号}    ${账户余额}    ${random}
    ${增加后金额}    两个整数相加取两位小数并去零    ${账户余额}    ${random}
    获取余额变动记录    ${G_用户手机号}
    获取余额变动记录-验证一条记录    1    储值账户    商户增加    ${float_random}    ${增加后金额}
    #test注释

商户增加余额，查看会员信息记录
    ${random}    ${float_random}    随机一个带两位小数的金额    0    2
    ${账户余额}    通过手机号获取用户账户信息    ${G_用户手机号}    balance
    ${累计充值金额}    通过手机号获取用户账户信息    ${G_用户手机号}    customerAmountRecharge
    增加余额    ${G_用户手机号}    ${账户余额}    ${random}
    ${增加后金额}    两个整数相加取两位小数并去零    ${账户余额}    ${random}
    ${账户余额-新}    通过手机号获取用户账户信息    ${G_用户手机号}    balance
    ${账户余额-新}    两个整数相加取两位小数并去零    ${账户余额-新}    0
    ${累计充值金额-新}    通过手机号获取用户账户信息    ${G_用户手机号}    customerAmountRecharge
    # 账户余额增加，累计充值金额不变
    Should Be Equal As Strings    ${增加后金额}    ${账户余额-新}
    Should Be Equal As Strings    ${累计充值金额}    ${累计充值金额-新}

商户增加余额，查看会员详情记录
    ${random}    ${float_random}    随机一个带两位小数的金额    0    2
    # 获取老数据
    ${账户余额}    通过手机号获取用户账户信息    ${G_用户手机号}    balance
    ${累计充值金额}    通过手机号获取用户账户信息    ${G_用户手机号}    customerAmountRecharge
    ${累计充值金额}    两个整数相加取两位小数并去零    ${累计充值金额}    0
    # 增加余额
    增加余额    ${G_用户手机号}    ${账户余额}    ${random}
    # 获取新数据
    ${增加后金额}    两个整数相加取两位小数并去零    ${账户余额}    ${random}
    获取会员明细    ${G_用户手机号}
    ${账户余额-新}    获取会员明细-获取账户信息    储值账户_储值卡
    ${累计充值金额-新}    获取会员明细-获取账户信息    累计充值金额
    ${累计充值金额-新}    小数去除末位0    ${累计充值金额-新}
    # 账户余额增加，累计充值金额不变
    Should Contain    ${账户余额-新}    ${增加后金额}
    Should Be Equal As Strings    ${累计充值金额}    ${累计充值金额-新}

商户扣减余额，查看余额变动记录
    ${random}    ${float_random}    随机一个带两位小数的金额    0    2
    ${账户余额}    通过手机号获取用户账户信息    ${G_用户手机号}    balance
    减少余额    ${G_用户手机号}    ${账户余额}    ${random}
    ${减少后金额}    两个整数相减取两位小数并去零    ${账户余额}    ${random}
    获取余额变动记录    ${G_用户手机号}
    获取余额变动记录-验证一条记录    1    储值账户    商户扣减    -${float_random}    ${减少后金额}

商户扣减余额，查看会员信息记录
    ${random}    ${float_random}    随机一个带两位小数的金额    0    2
    ${账户余额}    通过手机号获取用户账户信息    ${G_用户手机号}    balance
    ${累计充值金额}    通过手机号获取用户账户信息    ${G_用户手机号}    customerAmountRecharge
    减少余额    ${G_用户手机号}    ${账户余额}    ${random}
    ${减少后金额}    两个整数相减取两位小数并去零    ${账户余额}    ${random}
    ${账户余额-新}    通过手机号获取用户账户信息    ${G_用户手机号}    balance
    ${账户余额-新}    两个整数相减取两位小数并去零    ${账户余额-新}    0
    ${累计充值金额-新}    通过手机号获取用户账户信息    ${G_用户手机号}    customerAmountRecharge
    # 账户余额增加，累计充值金额不变
    Should Be Equal As Strings    ${减少后金额}    ${账户余额-新}
    Should Be Equal As Strings    ${累计充值金额}    ${累计充值金额-新}

商户扣减余额，查看会员详情记录
    ${random}    ${float_random}    随机一个带两位小数的金额    0    2
    # 获取老数据
    ${账户余额}    通过手机号获取用户账户信息    ${G_用户手机号}    balance
    ${累计充值金额}    通过手机号获取用户账户信息    ${G_用户手机号}    customerAmountRecharge
    ${累计充值金额}    两个整数相加取两位小数并去零    ${累计充值金额}    0
    # 扣减余额
    减少余额    ${G_用户手机号}    ${账户余额}    ${random}
    # 获取新数据
    ${减少后金额}    两个整数相减取两位小数并去零    ${账户余额}    ${random}
    获取会员明细    ${G_用户手机号}
    ${账户余额-新}    获取会员明细-获取账户信息    储值账户_储值卡
    ${累计充值金额-新}    获取会员明细-获取账户信息    累计充值金额
    ${累计充值金额-新}    小数去除末位0    ${累计充值金额-新}
    # 账户余额增加，累计充值金额不变
    Should Contain    ${账户余额-新}    ${减少后金额}
    Should Be Equal As Strings    ${累计充值金额}    ${累计充值金额-新}
